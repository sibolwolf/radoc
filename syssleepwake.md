
{{toc}}

# 系统进入休眠条件

~~~
1. 在首次配网绑定成功后，超过1min没有任何进入任何状态，设备自动进入休眠。
2. 在使用过程中，当满足以下全部情况，设备开始倒计时。当超过5min，设备自动进入休眠。
~~~

~~~
1. 摄像头处于非工作状态
2. 音频设备处于非占用状态
3. ra_main:没有资源处于下载状态
4. ra_main:没有资源处于解压缩状态
5. ra_main:没有资源处于同步状态
~~~

# 模块设计

## 模块信息

~~~
名称： syssleepwake
语言： go
~~~

## 提供锁id

~~~
cameralock
audiolock
downloadlock
decompresslock
synclock
~~~

## 锁状态

1:当前锁被占用。
0:当前锁被释放。

## 休眠设计流程

~~~
1. 满足以下任何条件。系统启动休眠
a）首次配网后，当以上锁全部处于释放状态。在1min内如果锁状态没有发生任何改变。
b）使用过程中，当以上锁全部处于释放状态。在5min内如果锁状态没有发生任何改变。
2. 发送close摄像头信号给ra_main并且收到返回确认。
3. 发送close音频信号给ra_main并且收到返回确认。
3. 关闭wifi
5. 发送系统将进入休眠信号给ra_main。
6. 切换电源灯状态。
7. 系统正式进入休眠。
~~~

## 唤醒设计流程

~~~
1. 按下功能健唤醒设备。
2. 发送open（init）摄像头／音频信号给ra_main。
3. 打开wifi。
4. 发送系统唤醒信号给ra_main。
5. 系统唤醒完成进入工作状态。
6. 进入新一轮休眠状态监测
~~~

## 接口设计

###

# 模块测试
